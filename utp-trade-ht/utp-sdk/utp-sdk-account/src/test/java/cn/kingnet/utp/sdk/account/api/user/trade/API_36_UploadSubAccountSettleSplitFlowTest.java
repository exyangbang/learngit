package cn.kingnet.utp.sdk.account.api.user.trade;

import cn.kingnet.utp.sdk.account.AccountClient;
import cn.kingnet.utp.sdk.account.api.UtpAccountTestCase;
import cn.kingnet.utp.sdk.account.dto.UploadSubAccountSettleSplitReqDTO;
import cn.kingnet.utp.sdk.account.dto.UploadSubAccountSettleSplitRespDTO;
import cn.kingnet.utp.sdk.core.dto.ServerResponse;
import cn.kingnet.utp.sdk.core.enums.AuthType;
import cn.kingnet.utp.sdk.core.enums.HttpRespStatus;
import cn.kingnet.utp.sdk.core.utils.DataUtil;
import com.alibaba.fastjson.JSON;
import lombok.extern.slf4j.Slf4j;
import org.junit.Test;

import java.io.File;
import java.nio.charset.StandardCharsets;
import java.time.LocalDate;
import java.time.LocalTime;
import java.time.format.DateTimeFormatter;

/**
 * @Description 子账户清算文件上送
 * @Author WJH
 * @Date 2020/02/12
 */
@Slf4j
public class API_36_UploadSubAccountSettleSplitFlowTest extends UtpAccountTestCase {
    @Test
    public void test() {
        try {
            AccountClient client = new AccountClient(createAuthorization(AuthType.HTSIGN), host);
            AccountClient.Builder<UploadSubAccountSettleSplitRespDTO> builder = client.newUploadSubAccountSettleSplitBuilder();
            // 初始化requestBody
            UploadSubAccountSettleSplitReqDTO reqDTO = new UploadSubAccountSettleSplitReqDTO();
            reqDTO.setClientTradeId(mockClientTransId());
            reqDTO.setReqDate(LocalDate.now().format(DateTimeFormatter.ofPattern("yyyyMMdd")));
            reqDTO.setReqTime(LocalTime.now().format(DateTimeFormatter.ofPattern("HHmmss")));
            reqDTO.setUserAccount("9100001101000006561"); //uat:9100001101000005573 sit:9100001101000000718
            reqDTO.setBatchNo(mockBatchNo());
            reqDTO.setSettleDate("20201030");
            reqDTO.setCallbackUrl("http://ksbisv.wangdunbao.cn/mockCallback/success200");

            byte[] fileAy = DataUtil.fileToByte(buildSubAccountSettleSplitFile(reqDTO));
            String content = DataUtil.deflaterAndEncode64(fileAy);
            reqDTO.setContent(content);

            builder.setReqData(reqDTO);

            log.info("子账户清算分账文件 请求报文:{}", JSON.toJSONString(builder.getReqData()));

            ServerResponse<UploadSubAccountSettleSplitRespDTO> serverResponse = send(builder);

            if (serverResponse.getRespData() == null) {
                log.error("子账户清算分账文件异常：响应结果为null", serverResponse.getThrowable());
            } else {
                UploadSubAccountSettleSplitRespDTO respDTO = serverResponse.getRespData();
                log.info("子账户清算分账文件 响应报文:{}", JSON.toJSONString(respDTO));
                HttpRespStatus httpRespStatus = HttpRespStatus.resolve(respDTO.getStatus());
                if (httpRespStatus.is2xxSuccessful()) {
                    log.info("子账户清算分账文件 成功");
                } else {
                    log.error("子账户清算分账文件失败：status[{}] {}", respDTO.getStatus(), respDTO.getMessage());
                }
            }
        } catch (Exception e) {
            log.error("子账户清算分账文件异常：{}", e.getMessage(), e);
        }
    }

    public File buildSubAccountSettleSplitFile(UploadSubAccountSettleSplitReqDTO reqDTO) {
        String tradeDate = "20201030";
        String batchNo = reqDTO.getBatchNo();
        int rows = 2;
        StringBuilder sb = new StringBuilder();
        sb.append(String.format("H|subaccount_settle|%s|%s", tradeDate, rows));

      /*  String transOrders = "377007617,377007618,377007619,377007620,377007621,377007622,377007623,377007624,377007625,377007626,377007627,377007628,377007629,377007630,377007631,511225346,511225347,511225348,511225349,511225350,511225351,511225352,511225353,511225354,511225355,511225356,511225357,511225358,511225359,511225360,511225361,511225362,511225363,511225364,511225365,511225366,511225367,511225368,511225369,511225370,511225371,511225372,511225373,511225374,511225375,511225376,511225377,511225378,511225379,511225380,511225381,511225382,511225383,511225384,511225385,511225386,511225387,511225388,511225389,511225390,511225391,511225392,511225393,511225394,511225395,511225396,511225397,511225398,511225399,511225400,511225401,511225402,511225403,511225404,511225405,511225406,511225407,511225408,511225409,511225410,511225411,511225412,511225413,511225414,511225415,511225416,511225417,511225418,511225419,511225420,511225421,511225422,511225423,511225424,511225425,511225426,511225427,511225428,511225429,511225430,511225431,511225432,511225433,511225434,511225435,511225436,511225437,511225438,511225439,511225440,511225441,511225442,511225443,511225444,511225445,511225446,511225447,511225448,511225449,511225450,511225451,511225452,511225453,511225454,511225455,511225456,511225457,511225458,511225459,511225460,511225461,511225462,511225463,511225464,511225465,511225466,511225467,511225468,511225469,511225470,511225471,511225472,511225473,511225474,511225475,511225476,511225477,511225478,511225479,511225480,511225481,511225482,511225483,511225484,511225485,511225486,511225487,511225488,511225489,511225490,511225491,511225492,511225493,511225494,511225495,511225496,511225497,511225498,511225499,511225500,511225501,511225502,511225503,511225504,511225505,511225506,511225507,511225508,511225509,511225510,511225511,511225512,511225513,511225514,511225515,511225516,511225517,511225518,511225519,511225520,511225521,511225522,511225523,511225524,511225525,511225526,511225527,511225528,511225529,511225530,511225531,511225532,511225533,511225534,511225535,511225536,511225537,511225538,511225539,511225540,511225541,511225542,511225543,511225544,511225545,511225546,511225547,511225548,511225549,511225550,511225551,511225552,511225553,511225554,511225555,511225556,511225557,511225558,511225559,511225560,511225561,511225562,511225563,511225564,511225565,511225566,511225567,511225568,511225569,511225570,511225571,511225572,771272193,771272194,771272195,771272196,771272197,771272198,771272199,771272200,771272201,771272202,771272203,771272204,771272205,771272206,771272207,771272208,771272209,771272210,771272211,771272212,771272213,771272214,771272215,771272216,771272217,771272218,771272219,771272220,771272221,771272222,771272223,771272224,771272225,771272226,771272227,771272228,771272229,771272230,771272231,771272232,771272233,771272234,771272235,771272236,771272237,771272238,771272239,771272240,771272241,771272242,771272243,771272244,771272245,771272246,771272247,771272248,771272249,771272250,771272251,771272252,771272253,771272254,771272255,771272256,771272257,771272258,771272259,771272260,771272261,771272262,771272263,771272264,771272265,771272266,771272267,771272268,771272269,771272270,771272271,771272272,771272273,771272274,771272275,771272276,771272277,771272278,771272279,771272280,771272281,771272282,771272283,771272284,771272285,771272286,771272287,771272288,771272289,771272290,771272291,771272292,771272293,771272294,771272295,771272296,771272297,838381058,838381059,838381060,838381061,838381062,838381063,838381064,838381065,838381066,838381067,838381068,838381069,838381070,838381071,838381072,838381073,838381074,838381075,838381076,838381077,838381078,838381079,838381080,838381081,838381082,838381083,838381084,838381085,838381086,838381087,838381088,838381089,838381090,838381091,838381092,838381093,838381094,838381095,838381096,838381097,838381098,838381099,838381100,838381101,838381102,838381103,838381104,838381105,838381106,838381107,838381108,838381109,838381110,838381111,838381112,838381113,838381114,838381115,838381116,838381117,838381118,838381119,838381120,838381121,838381122,838381123,838381124,838381125,838381126,838381127,838381128,838381129,838381130,838381131,838381132,838381133,838381134,838381135,838381136,838381137,838381138,838381139,838381140,838381141,838381142,838381143,838381144,838381145,838381146,838381147,838381148,838381149,838381150,838381151,838381152,838381153,838381154,838381155,838381156,838381157,838381158,838381159,838381160,838381161,838381162,838381163,838381164,838381165,838381166,838381167,838381168,838381169,838381170,838381171,838381172,838381173,838381174,838381175,838381176,838381177,838381178,838381179,838381180,838381181,838381182,838381183,838381184,838381185,838381186,838381187,838381188,838381189,838381190,838381191,838381192,838381193,838381194,838381195,838381196,838381197,838381198,838381199,838381200,901295617,901295618,901295619,901295620,901295621,901295622,901295623,901295624,901295625,901295626,901295627,901295628,901295629,901295630,901295631,901295632,901295633,901295634,901295635,901295636,901295637,901295638,901295639,901295640,901295641,901295642,901295643,901295644,901295645,901295646,901295647,901295648,901295649,901295650,901295651,901295652,901295653,901295654,901295655,901295656,901295657,901295658,901295659,901295660,901295661,901295662,901295663,901295664,901295665,901295666,901295667,901295668,901295669,901295670,901295671,968404482,968404483,968404484,968404485,968404486,968404487,968404488,035513345,035513346,035513347,035513348,035513349,035513350,035513351,035513352,035513353,035513354,035513355,035513356,035513357,035513358,035513359,035513360,035513361,035513362,035513363,035513364,035513365,035513366,035513367,035513368,035513369,035513370,035513371,035513372,035513373,035513374,035513375,035513376,035513377,035513378,035513379,035513380,035513381,035513382,035513383,035513384,035513385,035513386,035513387,035513388,035513389,035513390,035513391,035513392,035513393,035513394,035513395,035513396,035513397,035513398,035513399,035513400,035513401,035513402,035513403,035513404,035513405,035513406,035513407,035513408,035513409,035513410,035513411,035513412,035513413,035513414,035513415,035513416,035513417,035513418,035513419,035513420,035513421,035513422,035513423,035513424,035513425,035513426,035513427,035513428,035513429,035513430,035513431,035513432,035513433,035513434,035513435,035513436,035513437,035513438,035513439,035513440,035513441,035513442,035513443,035513444,035513445,035513446,035513447,035513448,035513449,035513450,035513451,035513452,035513453,098427905,098427906,098427907,098427908,098427909,098427910,098427911,098427912,098427913,098427914,098427915,098427916,098427917,098427918,098427919,098427920,098427921,098427922,098427923,098427924,098427925,098427926,098427927,098427928,098427929,098427930,098427931,098427932,098427933,098427934,098427935,098427936,098427937,098427938,098427939,098427940,098427941,098427942,098427943";
        //序号|清算日期|客户端流水号|分账子账户|金额|结算方式|账期|备注信息|子账户支付订单号列表|扩展字段2|扩展字段3
        sb.append("\n").append(String.format("%s|%s|%s|%s|%s|%s|%s|%s|%s|%s|%s",
                1, "20200720","2020021221UTP12275785635665115","9100001101000000717",100,"1","0","备注1",transOrders, "扩展02","扩展03"));
       sb.append("\n").append(String.format("%s|%s|%s|%s|%s|%s|%s|%s|%s|%s|%s",
                2, "20200720","2020021221UTP12275785635665116","9100001101000000716",200,"1","0","备注2",transOrders, "扩展02","扩展03"));
*/

      /*  String transOrders = "984793602,051902466,051902467,051902468,051902469,051902470,051902471,051902472,051902473,051902474,051902475,051902476,051902477,051902478,114817026,114817027,114817028,114817029,114817030,114817031,114817032,114817033,114817034,114817035,114817036,114817037,114817038,114817039,114817040,114817041,114817042,114817043,114817044,114817045,114817046,114817047,114817048,114817049,114817050,114817051,114817052,114817053,114817054,114817055,114817056,114817057,114817058,114817059,114817060,114817061,114817062,114817063,114817064,114817065,114817066,114817067,114817068,114817069,114817070,114817071,114817072,114817073,114817074,114817075,114817076,114817077,114817078,114817079,114817080,114817081,114817082,114817083,114817084,114817085,114817086,114817087,114817088,114817089,114817090,114817091,114817092,114817093,114817094,114817095,114817096,114817097,114817098,114817099,114817100,114817101,114817102,114817103,114817104,114817105,114817106,114817107,114817108,114817109,114817110,114817111,114817112,114817113,114817114,114817115,114817116,114817117,114817118,114817119,114817120,114817121,114817122,114817123,114817124,114817125,114817126,114817127,114817128,114817129,114817130,114817131,114817132,114817133,114817134,114817135,114817136,114817137,114817138,114817139,114817140,114817141,114817142,114817143,114817144,114817145,114817146,114817147,114817148,114817149,114817150,114817151,114817152,114817153,114817154,114817155,114817156,114817157,114817158,114817159,114817160,114817161,114817162,114817163,114817164,114817165,114817166,114817167,114817168,114817169,114817170,114817171,114817172,114817173,114817174,114817175,114817176,114817177,114817178,114817179,114817180,114817181,114817182,114817183,114817184,114817185,114817186,114817187,114817188,114817189,114817190,114817191,114817192,114817193,114817194,114817195,114817196,114817197,114817198,114817199,114817200,114817201,114817202,114817203,114817204,114817205,114817206,114817207,114817208,114817209,114817210,114817211,114817212,114817213,114817214,114817215,114817216,114817217,114817218,114817219,114817220,114817221,114817222,114817223,114817224,114817225,114817226,114817227,114817228,114817229,114817230,114817231,114817232,114817233,114817234,114817235,114817236,114817237,114817238,114817239,114817240,114817241,114817242,114817243,114817244,114817245,114817246,114817247,114817248,311949313,311949314,311949315,311949316,311949317,311949318,311949319,311949320,311949321,311949322,311949323,311949324,311949325,311949326,311949327,311949328,311949329,311949330,311949331,311949332,311949333,311949334,311949335,311949336,311949337,311949338,311949339,311949340,311949341,311949342,311949343,311949344,311949345,311949346,311949347,311949348,311949349,311949350,311949351,311949352,311949353,311949354,311949355,311949356,311949357,311949358,311949359,311949360,311949361,311949362,311949363,311949364,311949365,311949366,311949367,311949368,311949369,311949370,311949371,311949372,311949373,311949374,311949375,311949376,311949377,311949378,311949379,311949380,311949381,311949382,311949383,311949384,311949385,311949386,311949387,311949388,311949389,311949390,311949391,311949392,311949393,311949394,311949395,311949396,311949397,311949398,311949399,311949400,311949401,311949402,311949403,311949404,311949405,311949406,311949407,311949408,311949409,311949410,311949411,311949412,311949413,311949414,311949415,311949416,311949417,311949418,311949419,311949420,311949421,311949422,311949423,311949424,311949425,311949426,311949427,311949428,311949429,311949430,311949431,311949432,311949433,311949434,311949435,311949436,311949437,311949438,311949439,311949440,311949441,311949442,311949443,311949444,311949445,311949446,311949447,311949448,311949449,311949450,311949451,311949452,311949453,311949454,311949455,311949456,311949457,311949458,311949459,311949460,311949461,311949462,311949463,311949464,311949465,311949466,311949467,311949468,311949469,311949470,311949471,311949472,311949473,311949474,311949475,311949476,311949477,311949478,311949479,311949480,311949481,311949482,311949483,311949484,311949485,311949486,311949487,311949488,311949489,311949490,311949491,311949492,311949493,311949494,311949495,311949496,311949497,311949498,311949499,311949500,311949501,311949502,311949503,311949504,311949505,311949506,311949507,311949508,311949509,311949510,311949511,311949512,311949513,311949514,311949515,311949516,311949517,311949518,311949519,311949520,311949521,311949522,311949523,311949524,311949525,311949526,311949527,311949528,311949529,311949530,311949531,311949532,311949533,311949534,311949535,311949536,311949537,311949538,311949539,311949540,311949541,311949542,311949543,311949544,311949545,311949546,311949547,311949548,311949549,311949550,311949551,311949552,311949553,311949554,311949555,311949556,311949557,311949558,311949559,311949560,311949561,311949562,311949563,311949564,311949565,311949566,311949567,311949568,311949569,311949570,311949571,311949572,311949573,311949574,311949575,311949576,311949577,311949578,311949579,311949580,311949581,311949582,311949583,311949584,311949585,311949586,311949587,311949588,311949589,311949590,311949591,311949592,311949593,311949594,311949595,311949596,576190466,576190467,576190468,576190469,576190470,576190471,576190472,576190473,576190474,576190475,576190476,576190477,576190478,576190479,576190480,576190481,576190482,576190483,576190484,576190485,576190486,576190487,576190488,576190489,576190490,576190491,576190492,576190493,576190494,576190495,576190496,576190497,576190498,576190499,576190500,576190501,576190502,576190503,576190504,576190505,576190506,576190507,576190508,576190509,576190510,576190511,576190512,576190513,576190514,576190515,576190516,576190517,576190518,576190519,576190520,576190521,576190522,576190523,576190524,576190525,576190526,576190527,576190528,576190529,576190530,576190531,576190532,576190533,576190534,576190535,576190536,576190537,576190538,576190539,576190540,576190541,576190542,576190543,576190544,576190545,576190546,576190547,576190548,576190549,576190550,576190551,576190552,576190553,576190554,576190555,576190556,576190557,576190558,576190559,576190560,576190561,576190562,576190563,576190564,576190565,576190566,576190567,576190568,576190569,576190570,576190571,576190572,576190573,576190574,576190575,576190576,576190577,576190578,576190579,576190580,576190581,576190582,576190583,576190584,576190585,576190586,576190587,576190588,576190589,576190590,576190591,576190592,576190593,576190594,576190595,576190596,576190597,576190598,576190599,576190600,576190601,576190602,576190603,576190604,576190605,576190606,576190607,576190608,576190609,576190610,576190611,576190612,576190613,576190614,576190615,576190616,576190617,576190618,576190619,576190620,576190621,576190622,576190623,576190624,576190625,576190626,576190627,576190628,576190629,576190630,576190631,576190632,576190633,576190634,576190635,576190636,576190637,576190638,576190639,576190640,576190641,576190642,576190643,576190644";
        sb.append("\n").append(String.format("%s|%s|%s|%s|%s|%s|%s|%s|%s|%s|%s",
                1, "20200720","2020072017UTP1285140025969553410","9100001101000005572",100,"1","0","备注1",transOrders, "扩展02","扩展03"));
       sb.append("\n").append(String.format("%s|%s|%s|%s|%s|%s|%s|%s|%s|%s|%s",
                2, "20200720","2020072017UTP1285140025969553411","9100001101000005571",200,"1","0","备注2",transOrders, "扩展02","扩展03"));
*/


        String outsideTransOrderIds = "1287668514165743617,1287668514165743618,1287668514165743619,1287668514165743620,1287668514165743621,1287668514165743622,1287668514165743623,1287668514165743624,1287668514165743625,1287668514165743626,1287668514165743627,1287668514165743628,1287668514165743629,1287668514165743630,1287668514165743631,1287668514165743632,1287668514165743633,1287668514165743634,1287668514165743635,1287668514299961345,1287668514299961346,1287668514299961347,1287668514299961348,1287668514299961349,1287668514299961350,1287668514299961351,1287668514299961352,1287668514299961353,1287668514299961354,1287668514299961355,1287668514299961356,1287668514299961357,1287668514299961358,1287668514299961359,1287668514299961360,1287668514299961361,1287668514299961362,1287668514299961363,1287668514299961364,1287668514299961365,1287668514299961366,1287668514299961367,1287668514299961368,1287668514299961369,1287668514299961370,1287668514299961371,1287668514299961372,1287668514299961373,1287668514299961374,1287668514299961375,1287668514299961376,1287668514299961377,1287668514299961378,1287668514299961379,1287668514299961380,1287668514299961381,1287668514299961382,1287668514299961383,1287668514299961384,1287668514299961385,1287668514299961386,1287668514299961387,1287668514299961388,1287668514299961389,1287668514299961390,1287668514299961391,1287668514299961392,1287668514299961393,1287668514299961394,1287668514299961395,1287668514299961396,1287668514299961397,1287668514299961398,1287668514299961399,1287668514299961400,1287668514299961401,1287668514299961402,1287668514299961403,1287668514299961404,1287668514299961405,1287668514299961406,1287668514299961407,1287668514299961408,1287668514299961409,1287668514299961410,1287668514299961411,1287668514299961412,1287668514299961413,1287668514299961414,1287668514299961415,1287668514299961416,1287668514299961417,1287668514299961418,1287668514299961419,1287668514362875906,1287668514362875907,1287668514362875908,1287668514362875909,1287668514362875910,1287668514362875911,1287668514362875912,1287668514362875913,1287668514362875914,1287668514362875915,1287668514362875916,1287668514362875917,1287668514362875918,1287668514362875919,1287668514362875920,1287668514362875921,1287668514362875922,1287668514362875923,1287668514362875924,1287668514429984769,1287668514429984770,1287668514429984771,1287668514429984772,1287668514429984773,1287668514429984774,1287668514429984775,1287668514429984776,1287668514429984777,1287668514429984778,1287668514429984779,1287668514429984780,1287668514429984781,1287668514429984782,1287668514429984783,1287668514429984784,1287668514429984785,1287668514429984786,1287668514429984787,1287668514429984788,1287668514429984789,1287668514429984790,1287668514429984791,1287668514429984792,1287668514429984793,1287668514429984794,1287668514429984795,1287668514429984796,1287668514429984797,1287668514429984798,1287668514429984799,1287668514429984800,1287668514429984801,1287668514429984802,1287668514429984803,1287668514429984804,1287668514429984805,1287668514429984806,1287668514429984807,1287668514429984808,1287668514429984809,1287668514429984810,1287668514429984811,1287668514429984812,1287668514429984813,1287668514429984814,1287668514429984815,1287668514429984816,1287668514429984817,1287668514429984818,1287668514429984819,1287668514429984820,1287668514429984821,1287668514429984822,1287668514429984823,1287668514429984824,1287668514429984825,1287668514429984826,1287668514429984827,1287668514429984828,1287668514429984829,1287668514429984830,1287668514497093634,1287668514497093635,1287668514497093636,1287668514497093637,1287668514497093638,1287668514497093639,1287668514497093640,1287668514497093641,1287668514497093642,1287668514497093643,1287668514497093644,1287668514497093645,1287668514497093646,1287668514497093647,1287668514497093648,1287668514497093649,1287668514497093650,1287668514497093651,1287668514497093652,1287668514497093653,1287668514497093654,1287668514497093655,1287668514497093656,1287668514497093657,1287668514497093658,1287668514497093659,1287668514497093660,1287668514497093661,1287668514497093662,1287668514497093663,1287668514497093664,1287668514497093665,1287668514497093666,1287668514497093667,1287668514497093668,1287668514497093669,1287668514497093670,1287668514497093671,1287668514497093672,1287668514497093673,1287668514497093674,1287668514497093675,1287668514497093676,1287668514497093677,1287668514497093678,1287668514497093679,1287668514497093680,1287668514497093681,1287668514497093682,1287668514497093683,1287668514497093684,1287668514497093685,1287668514497093686,1287668514497093687,1287668514497093688,1287668514497093689,1287668514497093690,1287668514497093691,1287668514497093692,1287668514497093693,1287668514497093694,1287668514497093695,1287668514497093696,1287668514497093697,1287668514497093698,1287668514497093699,1287668514497093700,1287668514497093701,1287668514497093702,1287668514497093703,1287668514497093704,1287668514497093705,1287668514497093706,1287668514497093707,1287668514497093708,1287668514497093709,1287668514497093710,1287668514497093711,1287668514497093712,1287668514497093713,1287668514497093714,1287668514497093715,1287668514497093716,1287668514497093717,1287668514497093718,1287668514497093719,1287668514497093720,1287668514497093721,1287668514497093722,1287668514497093723,1287668514497093724,1287668514497093725,1287668514497093726,1287668514497093727,1287668514497093728,1287668514497093729,1287668514497093730,1287668514497093731,1287668514497093732,1287668514497093733,1287668514560008193,1287668514560008194,1287668514560008195,1287668514560008196,1287668514560008197,1287668514560008198,1287668514560008199,1287668514560008200,1287668514560008201,1287668514560008202,1287668514560008203,1287668514560008204,1287668514560008205,1287668514560008206,1287668514560008207,1287668514560008208,1287668514560008209,1287668514560008210,1287668514560008211,1287668514560008212,1287668514560008213,1287668514560008214,1287668514560008215,1287668514560008216,1287668514560008217,1287668514560008218,1287668514560008219,1287668514560008220,1287668514560008221,1287668514560008222,1287668514560008223,1287668514560008224,1287668514560008225,1287668514560008226,1287668514560008227,1287668514560008228,1287668514560008229,1287668514560008230,1287668514560008231,1287668514560008232,1287668514560008233,1287668514560008234,1287668514560008235,1287668514560008236,1287668514560008237,1287668514560008238,1287668514560008239,1287668514560008240,1287668514560008241,1287668514560008242,1287668514560008243,1287668514560008244,1287668514560008245,1287668514560008246,1287668514560008247,1287668514560008248,1287668514560008249,1287668514560008250,1287668514560008251,1287668514560008252,1287668514560008253,1287668514560008254,1287668514560008255,1287668514560008256,1287668514560008257,1287668514560008258,1287668514560008259,1287668514560008260,1287668514560008261,1287668514560008262,1287668514560008263,1287668514560008264,1287668514560008265,1287668514560008266,1287668514560008267,1287668514560008268,1287668514560008269,1287668514560008270,1287668514560008271,1287668514560008272,1287668514627117058,1287668514690031617,1287668514690031618,1287668514690031619,1287668514690031620,1287668514690031621,1287668514690031622,1287668514690031623,1287668514690031624,1287668514690031625,1287668514690031626,1287668514690031627,1287668514690031628,1287668514690031629,1287668514690031630,1287668514690031631,1287668514690031632,1287668514690031633,1287668514690031634,1287668514690031635,1287668514690031636,1287668514690031637,1287668514690031638,1287668514690031639,1287668514690031640,1287668514757140482,1287668514757140483,1287668514757140484,1287668514757140485,1287668514757140486,1287668514757140487,1287668514757140488,1287668514757140489,1287668514757140490,1287668514757140491,1287668514757140492,1287668514757140493,1287668514757140494,1287668514757140495,1287668514757140496,1287668514757140497,1287668514757140498,1287668514757140499,1287668514757140500,1287668514757140501,1287668514757140502,1287668514757140503,1287668514757140504,1287668514757140505,1287668514757140506,1287668514757140507,1287668514757140508,1287668514757140509,1287668514757140510,1287668514757140511,1287668514757140512,1287668514757140513,1287668514757140514,1287668514757140515,1287668514757140516,1287668514757140517,1287668514786500610,1287668514786500611,1287668514786500612,1287668514786500613,1287668514786500614,1287668514786500615,1287668514786500616,1287668514790694914,1287668514790694915,1287668514790694916,1287668514790694917,1287668514790694918,1287668514790694919,1287668514790694920,1287668514790694921,1287668514790694922,1287668514790694923,1287668514790694924,1287668514790694925,1287668514790694926,1287668514790694927,1287668514790694928,1287668514790694929,1287668514790694930,1287668514790694931,1287668514790694932,1287668514790694933,1287668514790694934,1287668514790694935,1287668514790694936,1287668514790694937,1287668514790694938,1287668514790694939,1287668514799083521,1287668514799083522,1287668514799083523,1287668514799083524,1287668514799083525,1287668514799083526,1287668514799083527,1287668514799083528,1287668514799083529,1287668514799083530,1287668514799083531,1287668514799083532,1287668514799083533,1287668514799083534,1287668514799083535,1287668514799083536,1287668514799083537,1287668514799083538,1287668514799083539,1287668514799083540,1287668514799083541,1287668514799083542,1287668514799083543,1287668514799083544,1287668514799083545,1287668514799083546,1287668514799083547,1287668514799083548,1287668514799083549,1287668514799083550,1287668514799083551,1287668514799083552,1287668514799083553,1287668514799083554,1287668514807472129,1287668514807472130,1287668514807472131,1287668514807472132,1287668514807472133,1287668514807472134,1287668514807472135,1287668514807472136,1287668514807472137,1287668514807472138,1287668514807472139,1287668514807472140,1287668514807472141,1287668514807472142,1287668514807472143,1287668514807472144,1287668514807472145,1287668514807472146,1287668514807472147,1287668514807472148,1287668514807472149,1287668514807472150,1287668514807472151,1287668514807472152,1287668514807472153,1287668514807472154,1287668514807472155,1287668514807472156,1287668514807472157,1287668514807472158,1287668514807472159,1287668514807472160,1287668514807472161,1287668514807472162,1287668514807472163,1287668514807472164,1287668514807472165,1287668514807472166,1287668514807472167,1287668514807472168,1287668514807472169,1287668514807472170,1287668514807472171,1287668514807472172,1287668514807472173,1287668514807472174,1287668514807472175,1287668514807472176,1287668514807472177,1287668514807472178,1287668514807472179,1287668514807472180,1287668514807472181,1287668514807472182,1287668514807472183,1287668514807472184,1287668514807472185,1287668514807472186,1287668514807472187,1287668514807472188,1287668514807472189,1287668514807472190,1287668514807472191,1287668514807472192,1287668514807472193,1287668514807472194,1287668514807472195,1287668514807472196,1287668514807472197,1287668514807472198,1287668514807472199,1287668514807472200,1287668514807472201,1287668514807472202,1287668514807472203,1287668514807472204,1287668514807472205,1287668514807472206,1287668514807472207,1287668514807472208,1287668514807472209,1287668514807472210,1287668514807472211,1287668514807472212,1287668514807472213,1287668514807472214,1287668514807472215,1287668514807472216,1287668514807472217,1287668514807472218,1287668514807472219,1287668514807472220,1287668514807472221,1287668514807472222,1287668514807472223,1287668514807472224,1287668514807472225,1287668514807472226,1287668514807472227,1287668514807472228,1287668514807472229,1287668514807472230,1287668514807472231,1287668514807472232,1287668514807472233,1287668514807472234,1287668514807472235,1287668514807472236,1287668514807472237,1287668514807472238,1287668514857803778,1287668514857803779,1287668514857803780,1287668514857803781,1287668514857803782,1287668514857803783,1287668514857803784,1287668514857803785,1287668514857803786,1287668514857803787,1287668514857803788,1287668514857803789,1287668514857803790,1287668514857803791,1287668514857803792,1287668514857803793,1287668514857803794,1287668514857803795,1287668514857803796,1287668514857803797,1287668514857803798,1287668514857803799,1287668514857803800,1287668514857803801,1287668514866192385,1287668514866192386,1287668514866192387,1287668514866192388,1287668514866192389,1287668514866192390,1287668514866192391,1287668514866192392,1287668514866192393,1287668514866192394,1287668514866192395,1287668514866192396,1287668514866192397,1287668514866192398,1287668514866192399,1287668514866192400,1287668514866192401,1287668514866192402,1287668514866192403,1287668514866192404,1287668514866192405,1287668514866192406,1287668514866192407,1287668514866192408,1287668514866192409,1287668514866192410,1287668514866192411,1287668514866192412,1287668514866192413,1287668514866192414,1287668514866192415,1287668514866192416,1287668514866192417,1287668514866192418,1287668514866192419,1287668514866192420,1287668514866192421,1287668514866192422,1287668514866192423,1287668514866192424,1287668514866192425,1287668514866192426,1287668514866192427,1287668514866192428,1287668514866192429,1287668514866192430,1287668514866192431,1287668514866192432,1287668514866192433,1287668514866192434,1287668514866192435,1287668514866192436,1287668514866192437,1287668514866192438,1287668514866192439,1287668514866192440,1287668514866192441,1287668514866192442,1287668514866192443,1287668514866192444,1287668514866192445,1287668514866192446,1287668514866192447,1287668514866192448,1287668514866192449,1287668514866192450,1287668514866192451,1287668514866192452,1287668514866192453,1287668514866192454,1287668514866192455,1287668514866192456,1287668514866192457,1287668514866192458,1287668514866192459,1287668514866192460,1287668514866192461,1287668514866192462,1287668514866192463,1287668514866192464,1287668514866192465,1287668514866192466,1287668514866192467,1287668514866192468,1287668514866192469,1287668514866192470,1287668514866192471,1287668514866192472,1287668514866192473,1287668514866192474,1287668514866192475,1287668514866192476,1287668514866192477,1287668514866192478,1287668514866192479,1287668514866192480,1287668514866192481,1287668514866192482,1287668514866192483,1287668514866192484,1287668514866192485,1287668514866192486,1287668514866192487,1287668514866192488,1287668514866192489,1287668514866192490,1287668514866192491,1287668514866192492,1287668514866192493,1287668514866192494,1287668514866192495,1287668514866192496,1287668514866192497,1287668514866192498,1287668514866192499,1287668514866192500,1287668514866192501,1287668514866192502,1287668514866192503,1287668514866192504,1287668514895552513,1287668514895552514,1287668514895552515,1287668514895552516,1287668514895552517,1287668514895552518,1287668514895552519,1287668514895552520,1287668514895552521,1287668514895552522,1287668514895552523,1287668514895552524,1287668514895552525,1287668514920718337,1287668514920718338,1287668514920718339,1287668514920718340,1287668514920718341,1287668514920718342,1287668514920718343,1287668514920718344,1287668514920718345,1287668514920718346,1287668514920718347,1287668514920718348,1287668514920718349,1287668514920718350,1287668514920718351,1287668514920718352,1287668514920718353,1287668514920718354,1287668514933301250,1287668514933301251,1287668514933301252,1287668514933301253,1287668514933301254,1287668514933301255,1287668514933301256,1287668514933301257,1287668514933301258,1287668514933301259,1287668514933301260,1287668514933301261,1287668514933301262,1287668514933301263,1287668514933301264,1287668514933301265,1287668514941689858,1287668514941689859,1287668514941689860,1287668514941689861,1287668514941689862,1287668514941689863,1287668514941689864,1287668514941689865,1287668514941689866,1287668514941689867,1287668514941689868,1287668514941689869,1287668514941689870,1287668514941689871,1287668514941689872,1287668514941689873,1287668514941689874,1287668514941689875,1287668514941689876,1287668514941689877,1287668514941689878,1287668514941689879,1287668514941689880,1287668514941689881,1287668514941689882,1287668514941689883,1287668514941689884,1287668514941689885,1287668514941689886,1287668514941689887,1287668514941689888,1287668514941689889,1287668514941689890,1287668514941689891,1287668514941689892,1287668514941689893,1287668514941689894,1287668514941689895,1287668514941689896,1287668514941689897,1287668514941689898,1287668514941689899,1287668514941689900,1287668514950078466,1287668514950078467,1287668514950078468,1287668514950078469,1287668514950078470,1287668514950078471,1287668514950078472,1287668514950078473,1287668514950078474,1287668514950078475,1287668514950078476,1287668514950078477,1287668514950078478,1287668514950078479,1287668514950078480,1287668514950078481,1287668514950078482,1287668514950078483,1287668514950078484,1287668514950078485,1287668514950078486,1287668514950078487,1287668514950078488,1287668514950078489,1287668514950078490,1287668514950078491,1287668514950078492,1287668514950078493,1287668514950078494,1287668514950078495,1287668514950078496,1287668514950078497,1287668514950078498,1287668514950078499,1287668514950078500,1287668514950078501,1287668514950078502,1287668514950078503,1287668514950078504,1287668514950078505,1287668514950078506,1287668514958467073,1287668514958467074,1287668514958467075,1287668514958467076,1287668514966855682,1287668514971049985,1287668514971049986,1287668514971049987,1287668514971049988,1287668514971049989,1287668514971049990,1287668514987827202,1287668514987827203,1287668514987827204,1287668514987827205,1287668514987827206,1287668514987827207,1287668514987827208,1287668514987827209,1287668514987827210,1287668514987827211,1287668514987827212,1287668514987827213,1287668514987827214,1287668514987827215,1287668514987827216,1287668514987827217,1287668514996215809,1287668514996215810,1287668514996215811,1287668514996215812,1287668514996215813,1287668514996215814,1287668514996215815,1287668514996215816,1287668514996215817,1287668514996215818,1287668514996215819,1287668515004604418,1287668515004604419,1287668515004604420,1287668515004604421,1287668515004604422,1287668515004604423,1287668515004604424,1287668515004604425,1287668515004604426,1287668515004604427,1287668515004604428,1287668515004604429,1287668515004604430,1287668515004604431,1287668515004604432,1287668515004604433,1287668515004604434,1287668515004604435,1287668515004604436,1287668515004604437,1287668515004604438,1287668515004604439,1287668515004604440,1287668515004604441,1287668515004604442,1287668515004604443,1287668515004604444,1287668515004604445,1287668515004604446,1287668515004604447,1287668515004604448,1287668515004604449,1287668515004604450,1287668515012993026,1287668515012993027,1287668515012993028,1287668515012993029,1287668515012993030,1287668515012993031,1287668515012993032,1287668515012993033,1287668515012993034,1287668515012993035,1287668515012993036,1287668515012993037,1287668515012993038,1287668515012993039,1287668515012993040,1287668515012993041,1287668515012993042,1287668515012993043,1287668515012993044,1287668515012993045,1287668515012993046,1287668515012993047,1287668515012993048,1287668515012993049,1287668515012993050,1287668515012993051,1287668515012993052,1287668515012993053,1287668515012993054,1287668515012993055,1287668515012993056,1287668515012993057,1287668515012993058,1287668515012993059,1287668515012993060,1287668515012993061,1287668515012993062,1287668515012993063,1287668515012993064,1287668515012993065,1287668515012993066,1287668515012993067,1287668515012993068,1287668515012993069,1287668515012993070,1287668515012993071,1287668515012993072,1287668515012993073,1287668515012993074,1287668515012993075,1287668515012993076,1287668515012993077,1287668515012993078,1287668515021381633,1287668515021381634,1287668515021381635,1287668515021381636,1287668515021381637,1287668515021381638,1287668515021381639,1287668515021381640";
        String userAccount = "9100001101000006511";
        outsideTransOrderIds = "1321719493617778936";
//        outsideTransOrderIds = outsideTransOrderIds.substring(0,20*200);
        for (int i = 0; i < rows; i++) {
            sb.append("\n");
            String clientTradeId = mockClientTransId();
            //序号|清算日期|客户端流水号|分账子账户|金额|结算方式|账期|备注信息|子账户支付订单号列表|扩展字段2|扩展字段3
            sb.append(String.format("%s|%s|%s|%s|%s|%s|%s|%s|%s|%s|%s", i+1,tradeDate, clientTradeId, userAccount, 10,1,0, "子账户分账"+i, outsideTransOrderIds,null,null));
        }
        DataUtil.byte2File(sb.toString().getBytes(StandardCharsets.UTF_8), getFilePath(), buildFileName(industryCode,reqDTO.getUserAccount(), batchNo));
        return new File(getFilePath(), buildFileName(industryCode,reqDTO.getUserAccount(), batchNo));
    }


    private String buildFileName(String industryCode,String subAccount, String batchNo) {
        return String.format("subAccount_settleSplit-%s-%s-%s.txt", industryCode, subAccount,batchNo);
    }
}
